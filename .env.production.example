# SMAE Production Environment Configuration
# SECURITY WARNING: This file contains sensitive credentials
# - Never commit this file to version control
# - Use strong, randomly generated passwords
# - Rotate credentials regularly

# ============================================================
# CRITICAL SECURITY SETTING
# ============================================================
# BIND_INTERFACE MUST be set to 127.0.0.1: in production
# This ensures all Docker services only listen on localhost
# and cannot be accessed from the network
BIND_INTERFACE="127.0.0.1:"

# ============================================================
# Service Ports (localhost only)
# ============================================================
SMAE_API_LISTEN=45000
MINIO_S3_LISTEN=45900
PG_DB_LISTEN=25432
SMAE_WEB_LISTEN=45902
METADB_LISTEN=45903
MINIO_CONSOLE_LISTEN=45901
SMTP_WEB_LISTEN=3004

# ============================================================
# API Configuration
# ============================================================
URL_LOGIN_SMAE="https://smae.e-siri.com/login"
API_HOST_NAME="api.smae.e-siri.com"

# ============================================================
# Database Configuration
# ============================================================
# SECURITY: Use strong, randomly generated passwords
POSTGRES_PASSWORD="CHANGE_ME_STRONG_PASSWORD_HERE"
POSTGRES_USER="smae"
POSTGRES_DB="smae_production"
DATABASE_URL="postgresql://smae:CHANGE_ME_STRONG_PASSWORD_HERE@db:5432/smae_production?schema=public&connection_limit=40"

# Metabase Database
MB_DB_DBNAME="metabase"
MB_DB_USER="postgres"
MB_DB_PASS="CHANGE_ME_STRONG_PASSWORD_HERE"
MB_DB_HOST="metadb_postgres"

# ============================================================
# MinIO / S3 Configuration
# ============================================================
# SECURITY: Use strong, randomly generated credentials
S3_HOST=http://minio:9000
S3_ACCESS_KEY="CHANGE_ME_ACCESS_KEY_HERE"
S3_SECRET_KEY="CHANGE_ME_SECRET_KEY_HERE"
S3_BUCKET="smae-storage"

MINIO_ROOT_USER="CHANGE_ME_MINIO_USER_HERE"
MINIO_ROOT_PASSWORD="CHANGE_ME_MINIO_PASSWORD_HERE"

# ============================================================
# Session & Encryption
# ============================================================
# CRITICAL: Use a strong random secret for JWT signing
# Generate with: openssl rand -base64 32
SESSION_JWT_SECRET="CHANGE_ME_JWT_SECRET_HERE"

# CRITICAL: Prisma field encryption key
# Generate with: npx @47ng/cloak-cli generate
# WARNING: If you lose this key, encrypted data cannot be recovered
# If restoring from backup, use the SAME key as the original
PRISMA_FIELD_ENCRYPTION_KEY="k1.aesgcm256.CHANGE_ME_BASE64_KEY_HERE"

# Comma-separated list of old keys for key rotation
PRISMA_FIELD_DECRYPTION_KEYS=""

# ============================================================
# Container Names
# ============================================================
DATA_PREFIX="prod"
PG_CONTAINER_NAME="smae_postgres"
API_CONTAINER_NAME="smae_api"
EMAILDB_CONTAINER_NAME="smae_emaildb"
MINIO_CONTAINER_NAME="smae_minio"
WEB_CONTAINER_NAME="smae_web"

# ============================================================
# Application Configuration
# ============================================================
CPF_OBRIGATORIO_SEM_RF=0
MATCH_EMAIL_RF_OBRIGATORIO=""

# ============================================================
# External Services
# ============================================================
SOF_API_PREFIX="http://smae_orcamento:80"
SOF_API_TOKEN="YOUR_SOF_API_TOKEN_HERE"

GEO_API_PREFIX="http://smae_geoloc:80/"
NOMINATIM_EMAIL="email@example.com"
AZURE_KEY="keep-value-even-if-not-using-azure"
USE_AZURE="false"

SEI_API_PREFIX="http://smae_sei:80/"
SEI_HOST="https://sei.example.gov.br/sei"
SEI_ENDPOINT_WSDL="controlador_ws.php?servico=sei"
SEI_SIGLA_SISTEMA="SEI"
SEI_API_TOKEN="YOUR_SEI_TOKEN_HERE"

TRANSFEREGOV_API_PREFIX="http://smae_transferegov:80/"
TRANSFEREGOV_API_TRANSFERENCIAS_PREFIX="http://smae_transferegov_transferencias:80/"
TRANSFEREGOV_TRANSFERENCIAS_DOWNLOAD_TTL_SECS=43200
TRANSFEREGOV_TRANSFERENCIAS_MAX_RETRIES=3
TRANSFEREGOV_TRANSFERENCIAS_COD_PROPONENTE_CIDADE=8216

# ============================================================
# Logging Configuration
# ============================================================
LOG_REQ_ON_DB=false
LOG_DB_SKIP_URL_LIST=/api/ping,/api/login

# ============================================================
# Performance Configuration
# ============================================================
DOTACAO_SOF_SIMULTANEIDADE=16

# ============================================================
# Network Configuration
# ============================================================
DOCKER_MTU=1500

# ============================================================
# Frontend Configuration
# ============================================================
VITE_API_URL="https://api.smae.e-siri.com"

# ============================================================
# Metabase Configuration
# ============================================================
MB_SITE_URL="https://metadb.smae.e-siri.com"

# ============================================================
# Path Configuration
# ============================================================
# Path where persistent data will be stored on the VM
DATA_PATH="/data/smae"
